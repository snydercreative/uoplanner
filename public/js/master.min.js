"use strict";var namespacer=function(e){var l=e.split("."),t=window;if(l.length)for(var a=0;a<l.length;a++){var n=l[a];void 0===t[n]&&(t[n]={}),t=t[n]}};namespacer("uoplanner"),uoplanner.ruleManager=function(){var e={ruleSet:"Renaissance",skillMax:100,skillTotal:700},l={ruleSet:"Outlands",skillMax:120,skillTotal:720};return{getRules:function(){if(localStorage){var e=localStorage.uoplannerRules;try{return e&&JSON.parse(e)}catch(e){return console.error(e),{}}}console.log("No localStorage.")},setRules:function(t){if(localStorage)try{return localStorage.uoplannerRules="Renaissance"===t?JSON.stringify(e):JSON.stringify(l),!0}catch(e){return console.error("Error parsing settings form localStorage."),!1}console.error("No localStorage.")}}}(),namespacer("uoplanner"),uoplanner.hamburgerMenu=function(e,l){var t=function(l){e("#template-search-modal").addClass("active")},a=function(e){window.location.href="/build"},n=function(l){e("#template-search-modal").removeClass("active")};return{init:function(){e(".hamburger-menu button.search").on("click",t),e(".hamburger-menu button.create").on("click",a),e(".modal-wrapper.search .close").on("click",n)}}}(jQuery),$(function(){uoplanner.hamburgerMenu.init()});var skillsApp=angular.module("skillsApp",["ngTagsInput"]).config(["$locationProvider",function(e){e.html5Mode({enabled:!0,requireBase:!1})}]);skillsApp.controller("BuildCtrl",["$scope","templateService","skillListService","naughtyService",function(e,l,t,a){var n=this;n.uoplannerRules=uoplanner.ruleManager.getRules(),n.skills=[],n.templateName="",n.urlName="",n.templateId="",n.skillList=[],n.rangeValue=100,n.skillName="",n.skillTotal=0,t.getAll(function(e){n.skillList=e}),n.switchRulesModalButtonClick=function(e){n.switchRules(e),n.dismissModal()},n.switchRules=function(e){uoplanner.ruleManager.setRules(e),n.skillTotal=0,n.skills=[],n.templateName="",n.uoplannerRules=uoplanner.ruleManager.getRules()};new Clipboard("#sharing button");angular.element("#sharing button").on("click",function(e){var l=angular.element(e.currentTarget);l.text("Copied!").animate({top:"-50px",opacity:0},250,function(){l.text("Copy").animate({top:0,opacity:1},250)})}),n.setSkillInput=function(e){n.skillName=e.skill,angular.element(".skill-modal .skill-list").slideUp(250)},n.displaySkillList=function(){angular.element(".skill-modal .skill-list").slideDown(250)},n.displayAddSkillModal=function(){n.skillName="",angular.element("#skills-modal").addClass("active")},n.displaySwitchRulesModal=function(){n.skillName="",angular.element("#rule-switch-modal").addClass("active")},n.displayTemplateNameModal=function(){angular.element("#template-name-modal").addClass("active")},n.dismissModal=function(){angular.element(".modal-wrapper.active").removeClass("active")},n.editSkill=function(e){var l=n.skills.filter(function(l){return l.name===e});if(l)return n.skillName=l[0].name,n.rangeValue=l[0].value,void angular.element("#skills-modal").addClass("active");i("Skill not found.",!1)},n.removeSkill=function(e){var l=angular.element(e.currentTarget),t=l.closest("tr"),a=l.attr("data-skill-name"),i=1*l.attr("data-skill-value");n.skillTotal-=i;for(var s=0;s<n.skills.length;s++)if(n.skills[s].name===a)return n.skills.splice(s,1),void t.detach()},n.addSkill=function(e){for(var l=-1,t=0;t<n.skills.length;t++)if(n.skills[t].name===e.name){n.skillTotal-=n.skills[t].value,l=t;break}return n.skillTotal+e.value>n.uoplannerRules.skillTotal?void i("This would put you over the skill cap.",!0):e.name&&0!==e.value?-1===n.skillList.indexOf(e.name)?void i("Please pick an actual UO skill.",!0):n.skills[l]?(n.skills[l].value=e.value,n.skillTotal=n.skillTotal?e.value+n.skillTotal:e.value,angular.element(".skill-modal .skill-list").slideUp(250),n.dismissModal(),void i("Your template has unsaved changes.")):(n.skills.push(e),n.skillTotal+=e.value,angular.element(".skill-modal .skill-list").slideUp(250),n.dismissModal(),void i("Your template has unsaved changes.")):void i("You must select a skill and set a value greater than 0.",!0)},n.setTemplateName=function(e){e.toLowerCase().trim().replace(/\s/g,"_").replace(/\W/g,"").replace(/_/g,"-").replace(/--/g,"-")?o(e,function(l){if(l)return void i("Please pick a different name. You know why.",!0);n.templateName=e,angular.element("#templateName").text(e),n.dismissModal(),i("Your template has unsaved changes.")}):i("You must set a valid template name",!0)},n.saveTemplate=function(){n.templateName&&n.skills.length?l.save(n.skills,n.templateName,"",n.uoplannerRules.ruleSet,function(e){n.templateId=e.templateId,n.urlName=e.urlName,i("Skill template saved!"),s(n.templateId,n.urlName)}):i("You must set a template name and add skills to save.",!1)};var i=function(e,l){var t=l?".panel > .modal-warning":"body > .warning",a=angular.element(t);a.find("p").text(e),a.slideDown(250,function(){setTimeout(function(){a.slideUp(250)},1500)})},s=function(e,l){var t=window.location.origin+"/share/"+e+"/"+l;angular.element("#sharing .link").removeClass("inactive").text(t),angular.element("#sharing button").show()},o=function(e,l){a.isNaughty(e,function(e){l(e.isNaughty)})}}]),skillsApp.controller("HomeCtrl",["$http",function(e){var l=this;l.recentData=[],l.uoplannerRules=uoplanner.ruleManager.getRules(),l.uoplannerRules||uoplanner.ruleManager.setRules(),l.switchRules=function(e){uoplanner.ruleManager.setRules(e),l.uoplannerRules=uoplanner.ruleManager.getRules(),l.recentData=[],t()};var t=function(){l.uoplannerRules=uoplanner.ruleManager.getRules(),e.get("/api/v1/template/recent/"+l.uoplannerRules.ruleSet).then(function(e){l.recentData=t(e.data)},function(e){console.log(e)});var t=function(e){for(var l=0;l<e.length;l++){var t=new Date(e[l].lastModified);e[l].lastModified=t.toLocaleDateString()+" @ "+t.toLocaleTimeString(),e[l].url="/share/"+e[l].templateId+"/"+e[l].urlName}return e}};t()}]),skillsApp.controller("SearchBoxCtrl",["skillListService",function(e){var l=this;l.skillTags=[],e.getAll(function(e){l.skills=e}),l.displaySkillList=function(){angular.element("#template-search-modal .skill-list").slideDown(250)},l.addSkillTag=function(e){-1===l.skillTags.indexOf(e.skill)&&l.skillTags.length<3&&l.skillTags.push(e.skill),l.skillName="",angular.element("#template-search-modal .skill-list").slideUp(250)},l.search=function(){if(l.skillTags.length){var e=l.skillTags.join(",");window.location="/search?q="+e}}}]),skillsApp.controller("SearchCtrl",["$location","searchService","skillListService",function(e,l,t){var a=this;a.searchTerms=e.search().q,a.skillResults=[],a.nameResults=[],l.findSkills(a.searchTerms,function(e){console.log(e),angular.forEach(e,function(e){var l=new Date(e.lastModified);e.lastModified=l.toLocaleDateString()+" @ "+l.toLocaleTimeString()}),a.skillResults=e})}]),skillsApp.controller("ShareCtrl",["templateService","$location","$scope",function(e,l,t){var a=this;a.templateId=encodeURIComponent(window.location.pathname.split("/")[2]),a.urlName=encodeURIComponent(window.location.pathname.split("/")[3]),a.shareUrl=window.location.origin+"/share/"+a.templateId+"/"+a.urlName,e.get(a.templateId,a.urlName,function(e){a.skills=e.skills,a.templateName=e.name,a.ruleSet=e.ruleSet}),angular.element("#sharing button").on("click",function(e){var l=angular.element(e.currentTarget);l.text("Copied!").animate({top:"-20px",opacity:0},250,function(){setTimeout(function(){l.text("Copy").animate({top:0,opacity:1},250)},500)})})}]),skillsApp.factory("naughtyService",["$http",function(e){return{isNaughty:function(l,t){e.get("/api/v1/template/naughty/"+l).then(function(e){t(e.data)},function(e){console.log(e)})}}}]),skillsApp.factory("searchService",["$http","skillListService",function(e,l){return{findSkills:function(l,t){e.get("/api/v1/search/skills?q="+l).then(function(e){t(e.data)},function(e){console.log(e)})},findNames:function(l,t){e.get("/api/v1/search/names?q="+l).then(function(e){t(e.data)},function(e){console.log(e)})}}}]),skillsApp.factory("skillListService",["$http",function(e){return{getAll:function(l){e.get("/data/skills.json").then(function(e){l(e.data.skills)},function(e){console.log(e)})}}}]),skillsApp.factory("templateService",["$http",function(e){return{save:function(l,t,a,n,i){var s={skills:l,templateName:t,ruleSet:n,templateId:a};e.post("/api/v1/template/save",s).then(function(e){i(e.data)},function(e){console.log(e)})},get:function(l,t,a){e.get("/api/v1/template/get/"+l+"/"+t).then(function(e){a(e.data)},function(e){console.log(e)})}}}]),skillsApp.directive("rulesetSwitcher",function(){return{templateUrl:"views/rulesetSwitcher/rulesetSwitcher.html",controller:["$scope",function(e){return{changeRuleset:function(e){uoplanner.ruleManager.setRules(e)}}}],controllerAs:"vm"}});
//# sourceMappingURL=master.min.js.map
